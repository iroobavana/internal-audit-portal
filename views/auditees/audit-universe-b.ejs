<!DOCTYPE html>
<html>
<head>
  <title><%= title %> - Internal Audit Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
  <%- include('../partials/navbar') %>
  <%- include('../partials/messages') %>
  
  <div class="container-fluid mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="bi bi-grid"></i> Audit Universe - <%= auditee.name %></h1>
      <a href="/auditees" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Back to Auditees
      </a>
    </div>
    
    <div class="card mb-4">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0">Add New Entry</h5>
      </div>
      <div class="card-body">
        <form action="/auditees/<%= auditee.id %>/audit-universe" method="POST">
          <div class="row">
            <div class="col-md-3 mb-3">
              <label class="form-label">Department *</label>
              <select name="department_id" class="form-select" required>
                <option value="">-- Select --</option>
                <% departments.forEach(dept => { %>
                  <option value="<%= dept.id %>"><%= dept.department_name %></option>
                <% }) %>
              </select>
            </div>
            
            <div class="col-md-3 mb-3">
              <label class="form-label">Audit Area *</label>
              <input type="text" name="audit_area" class="form-control" required>
            </div>
            
            <div class="col-md-3 mb-3">
              <label class="form-label">Process</label>
              <input type="text" name="process" class="form-control">
            </div>
            
            <div class="col-md-3 mb-3">
              <label class="form-label">Inherent Risk</label>
              <input type="text" name="inherent_risk" class="form-control">
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Control Measure</label>
              <textarea name="control_measure" class="form-control" rows="2"></textarea>
            </div>
            
            <div class="col-md-6 mb-3">
              <label class="form-label">Audit Procedure</label>
              <textarea name="audit_procedure" class="form-control" rows="2"></textarea>
            </div>
          </div>
          
          <div class="text-end">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-plus-circle"></i> Add Entry
            </button>
          </div>
        </form>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0">Audit Universe Entries</h5>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered table-sm">
            <thead>
              <tr>
                <th>Department</th>
                <th>Audit Area</th>
                <th>Process</th>
                <th>Inherent Risk</th>
                <th>Control Measure</th>
                <th>Audit Procedure</th>
              </tr>
            </thead>
            <tbody>
              <% if (universe.length === 0) { %>
                <tr>
                  <td colspan="6" class="text-center text-muted">No entries yet. Add your first entry above!</td>
                </tr>
              <% } else { %>
                <% universe.forEach(entry => { %>
                  <tr>
                    <td><%= entry.department_name %></td>
                    <td><%= entry.audit_area %></td>
                    <td><%= entry.process || '-' %></td>
                    <td><%= entry.inherent_risk || '-' %></td>
                    <td><%= entry.control_measure || '-' %></td>
                    <td><%= entry.audit_procedure || '-' %></td>
                  </tr>
                <% }) %>
              <% } %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
